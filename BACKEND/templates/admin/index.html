{% extends "admin/index.html" %}
{% load i18n static %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static 'admin/css/custom_dashboard.css' %}">
{% endblock %}

{% block content %}
<div id="content-main" class="custom-dashboard">
    <!-- Welcome Banner -->
    <div class="welcome-banner">
        <h1>Welcome, {{ user.get_full_name|default:user.username }}</h1>
        <p>Last login: {{ user.last_login|date:"n/j/Y, g:i:s A" }}</p>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
        <div class="stats-card blue">
            <div class="stats-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
            </div>
            <div class="stats-info">
                <h3>{{ dashboard_stats.total_students }}</h3>
                <p>Total Students</p>
            </div>
        </div>
        <div class="stats-card green">
            <div class="stats-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
            </div>
            <div class="stats-info">
                <h3>{{ dashboard_stats.active_volunteers }}</h3>
                <p>Active Volunteers</p>
            </div>
        </div>
        <div class="stats-card yellow">
            <div class="stats-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                </svg>
            </div>
            <div class="stats-info">
                <h3>ksh{{ dashboard_stats.monthly_donations|floatformat:2 }}</h3>
                <p>Monthly Donations</p>
            </div>
        </div>
        <div class="stats-card red">
            <div class="stats-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                    <polyline points="22,6 12,13 2,6"></polyline>
                </svg>
            </div>
            <div class="stats-info">
                <h3>{{ dashboard_stats.new_messages }}</h3>
                <p>New Messages</p>
            </div>
        </div>
        <div class="stats-card teal">
            <div class="stats-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
            </div>
            <div class="stats-info">
                <h3>{{ dashboard_stats.upcoming_events }}</h3>
                <p>Upcoming Events</p>
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <div class="dashboard-tabs">
        <button class="tab-link active"><a href="/admin/students/student/">Students</a></button>
        <button class="tab-link"><a href="/admin/donations/donation/">Donations</a></button>
        <button class="tab-link"><a href="/admin/volunteers/volunteer/">Volunteers</a></button>
        <button class="tab-link"><a href="/admin/users/customuser/">Users</a></button>
        <button class="tab-link"><a href="/admin/contact/contactmessage/">Messages</a></button>
        <button class="tab-link"><a href="/admin/programs/program/">Content</a></button>
        <button class="tab-link"><a href="/admin/contact/siteconfiguration/">Settings</a></button>
    </div>

    <!-- Recent Donations Table -->
    <div id="Donations" class="tab-content active">
        <h2>Recent Donations</h2>
        <table class="recent-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Donor</th>
                    <th>Amount</th>
                    <th>Method</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for donation in dashboard_stats.recent_donations %}
                <tr>
                    <td>{{ donation.created_at|date:"n/j/Y" }}</td>
                    <td>{{ donation.donor_name }}</td>
                    <td>ksh{{ donation.amount|floatformat:2 }}</td>
                    <td>{{ donation.get_payment_method_display }}</td>
                    <td><span class="status-badge {{ donation.status }}">{{ donation.get_status_display }}</span></td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">No recent donations.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="admin-apps-list" style="margin-top: 40px; border-top: 1px solid #eee; padding-top: 20px;">
        <h3>All Applications</h3>
        {{ block.super }}
    </div>
</div>
{% endblock %}